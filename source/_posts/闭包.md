---
title: 闭包
date: 2019-05-03
tags:
  - IT技术
  - 前端
  - Javascript
---

#### 闭包的概念
> 函数作为返回值，函数嵌套函数

#### 闭包的优点和缺点
> 都是数据持久化

#### 代码示例
```
function f1(){
    var num = 10;
    num++;
    return num;
}

console.log(f1());  // 11
console.log(f1());  // 11
console.log(f1());  // 11

function f2(){
    var num = 10;
    return function(){
        num++;
        return num;
    }
}

var f = f2();
console.log(f());  // 11
console.log(f());  // 12
console.log(f());  // 13

//第2种写法  
var Circle = function() {  
   var obj = new Object();  
   obj.PI = 3.14159;  
     
   obj.area = function( r ) {  
       return this.PI * r * r;  
   }  
   return obj;  
}  
  
var c = new Circle();  
alert( c.area( 1.0 ) );  

//第3种写法  
var Circle={  
   "PI":3.14159,  
    "area":function(r){  
          return this.PI * r * r;  
    }  
};  
alert( Circle.area(1.0) ); 

//第4种写法  
var Circle = new Function("this.PI = 3.14159;this.area = function( r ) {return r*r*this.PI;}");  
  
alert( (new Circle()).area(1.0) );  

```

#### 闭包所造成的内存泄漏
> 了解到浏览器有两个回收机制叫做–引用计数和和标记清除。
而js中对象的赋值是传的地址，也就是引用赋值，其他数字、字符串、布尔类型的是传值赋值，由于闭包的原因，导致这个变量会一直保存在内存中，如果是对象变量(包括数组和函数)则使得引用次数不为0，如果是其余变量则使得此变量标记为正在被使用，所以浏览器就利用自身的回收机制将其释放。
==不管浏览器到底是利用哪种回收机制去回收内存，这里可以确定的是因为闭包的特性使得浏览器无法进行正常回收，需要我们自己手动清理==



